<!DOCTYPE html>
<html lang="en" class="w-full h-full overflow-x-hidden">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title>{% block title %}CEST Master IP Tool{% endblock %}</title>
    {% set theme = (current_user.theme if current_user else 'dark_colourful') if current_user is defined else 'dark_colourful' %}
    {% set font = (current_user.font if current_user else 'sans') if current_user is defined else 'sans' %}
    <link rel="stylesheet" href="{{ request.url_for('static', path='themes/' ~ theme ~ '.css') }}">
    <link rel="stylesheet" href="{{ request.url_for('static', path='fonts/' ~ font ~ '.css') }}">
    <link rel="stylesheet" href="/static/css/unocss.css">
    <link rel="stylesheet" href="{{ request.url_for('static', path='css/layout.css') }}">
  </head>
  <body class="w-full h-full overflow-x-hidden">
    <div id="app" class="min-h-screen w-full overflow-x-hidden">
    <header>
      <div class="top-header">
        <div class="px-6 mx-auto max-w-screen-2xl flex items-center justify-between">
          <div class="logo-box flex items-center">
            {% if logo_url() %}
            <img src="{{ logo_url() }}" alt="Logo" class="h-10 mr-2" />
            {% endif %}
            <span class="text-[var(--btn-text)] text-base">CEST Master IP and Config Tool</span>
          </div>
          <div class="login-area flex items-center space-x-2">
            {% if current_user %}
            <div class="relative" x-data="{open:false, ready:false}" x-init="setTimeout(() => ready = true, 50)">
              <button @click="open = !open" class="px-4 py-1.5 bg-[var(--btn-bg)] hover:bg-[var(--btn-hover)] text-[var(--btn-text)] rounded shadow transition">My Profile</button>
              <ul x-show="ready && open" x-transition.opacity.duration.150ms @click.away="open = false" class="absolute right-0 mt-2 bg-[var(--card-bg)] text-[var(--btn-text)] py-2 w-48" x-cloak>
                <li><a class="block px-4 py-2 hover:bg-[var(--btn-hover)]" href="/users/me">View Profile</a></li>
                <li><a class="block px-4 py-2 hover:bg-[var(--btn-hover)]" href="/user/ssh">SSH Profiles</a></li>
              </ul>
            </div>
            <a href="/auth/logout" class="px-4 py-1.5 bg-[var(--btn-bg)] hover:bg-[var(--btn-hover)] text-[var(--btn-text)] rounded shadow transition logged-in">Logout</a>
            {% else %}
            <a href="/auth/login" class="px-4 py-1.5 bg-[var(--btn-bg)] hover:bg-[var(--btn-hover)] text-[var(--btn-text)] rounded shadow transition logged-out">Login</a>
            {% endif %}
          </div>
        </div>
      </div>
      {% block nav %}
      {% set ms = (
        current_user.menu_style if current_user is defined and current_user
        and current_user.menu_style in ['tabbed','dropdown']
        else 'tabbed'
      ) %}
      {% if ms == 'dropdown' %}
        {% include 'nav_dropdown.html' %}
      {% else %}
        {% include 'nav_tabbed.html' %}
      {% endif %}
      {% endblock %}
    </header>
      <div id="page-content" class="w-full mt-4 opacity-0 transition-opacity duration-200" x-init="$el.classList.add('opacity-100')">
        <div class="px-6 mx-auto max-w-screen-2xl">
          <p class="text-base text-[var(--card-text)]">{{ message }}</p>
          {% block content %}{% endblock %}
        </div>
      </div>
    <script src="{{ request.url_for('static', path='js/alpine.min.js') }}" defer></script>
    <script src="{{ request.url_for('static', path='js/table.js') }}" defer></script>
    {% block extra_scripts %}{% endblock %}
    </div>
  </body>
</html>

{% extends "base.html" %}

{% block content %}
<h1 class="text-xl mb-4">Tag Manager</h1>
<table class="min-w-full text-left mt-4">
  <thead>
    <tr>
      <th class="px-4 py-2 text-left">Tag</th>
      <th class="px-4 py-2 text-left">Count</th>
      <th class="px-4 py-2 text-left">Rename</th>
      <th class="px-4 py-2 text-left">Merge Into</th>
      <th class="px-4 py-2"></th>
    </tr>
  </thead>
  <tbody>
  {% for tag in tags %}
    <tr class="border-t border-gray-700">
      <td class="px-4 py-2">{{ tag.name }}</td>
      <td class="px-4 py-2">{{ counts.get(tag.id, 0) }}</td>
      <td class="px-4 py-2">
        <form method="post" action="/admin/tags/{{ tag.id }}/rename" class="inline">
          <input type="text" name="new_name" class="w-32 p-1 text-black" />
          <button type="submit" class="px-4 py-2 text-white bg-gray-600 hover:bg-gray-700 rounded transition">Rename</button>
        </form>
      </td>
      <td class="px-4 py-2">
        <form method="post" action="/admin/tags/{{ tag.id }}/merge" class="inline">
          <select name="target_id" class="text-black">
            {% for t in tags %}
              {% if t.id != tag.id %}
              <option value="{{ t.id }}">{{ t.name }}</option>
              {% endif %}
            {% endfor %}
          </select>
          <button type="submit" class="px-4 py-2 text-white bg-yellow-600 hover:bg-yellow-700 rounded transition">Merge</button>
        </form>
      </td>
      <td class="px-4 py-2">
        <form method="post" action="/admin/tags/{{ tag.id }}/delete" class="inline">
          <button type="submit" class="px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded transition" onclick="return confirm('Delete tag?')">Delete</button>
        </form>
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}

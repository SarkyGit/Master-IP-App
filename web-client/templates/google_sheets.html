{% extends "base.html" %}

{% block content %}
<h1 class="text-xl mb-4">Google Sheets Integration</h1>

<form method="post" action="/tasks/google-sheets-config" class="space-y-2 mb-4">
  <div class="form-row">
    <div class="form-item space-y-2">
      <label for="service_account_json" class="block">Service Account JSON Path</label>
      <input id="service_account_json" type="text" name="service_account_json" value="{{ config.creds }}" class="w-full p-2 rounded bg-[var(--input-bg)] text-[var(--input-text)] border border-[var(--border-color)]">
    </div>
    <div class="form-item space-y-2">
      <label for="spreadsheet_id" class="block">Spreadsheet ID</label>
      <input id="spreadsheet_id" type="text" name="spreadsheet_id" value="{{ config.sheet_id }}" class="w-full p-2 rounded bg-[var(--input-bg)] text-[var(--input-text)] border border-[var(--border-color)]">
    </div>
  </div>
  <span aria-label="Save" class="p-2 rounded shadow transition cursor-pointer" role="button" tabindex="0" onclick="this.closest('form').submit()">{{ include_icon('save') }}</span>
</form>

<hr class="my-4">
<h2 class="text-lg mb-2">Export Table to Sheets</h2>
<form method="post" action="/tasks/export-google" class="flex flex-wrap items-center gap-2 mb-4">
  <select name="table_name" class="p-1 rounded bg-[var(--input-bg)] text-[var(--input-text)] border border-[var(--border-color)]">
    <option value="devices">Devices</option>
    <option value="vlans">VLANs</option>
    <option value="device_types">Device Types</option>
    <option value="ssh_credentials">SSH Credentials</option>
    <option value="snmp_communities">SNMP Communities</option>
    <option value="port_config_templates">Port Config Templates</option>
  </select>
  <span aria-label="Export" class="p-2 rounded shadow transition cursor-pointer" role="button" tabindex="0" onclick="this.closest('form').submit()">{{ include_icon('download','text-orange-500') }}</span>
</form>

<hr class="my-4">
<h2 class="text-lg mb-2">Import Table from Sheets</h2>
<form method="post" action="/tasks/import-google" class="flex flex-wrap items-center gap-2 mb-4">
  <select name="table_name" class="p-1 rounded bg-[var(--input-bg)] text-[var(--input-text)] border border-[var(--border-color)]">
    <option value="devices">Devices</option>
    <option value="vlans">VLANs</option>
    <option value="device_types">Device Types</option>
    <option value="ssh_credentials">SSH Credentials</option>
    <option value="snmp_communities">SNMP Communities</option>
    <option value="port_config_templates">Port Config Templates</option>
  </select>
  <span aria-label="Import" class="p-2 rounded shadow transition cursor-pointer" role="button" tabindex="0" onclick="this.closest('form').submit()">{{ include_icon('upload','text-orange-500') }}</span>
</form>
{% endblock %}
